### SAMI Password Reset API Tests
### Base URL: http://localhost:8383

# ==================================================
# 1. Test Forgot Password
# ==================================================

### Test forgot password with valid email
POST http://localhost:8383/api/auth/forgot-password
Content-Type: application/json

{
  "email": "test@example.com"
}

### Test forgot password without email (should fail)
POST http://localhost:8383/api/auth/forgot-password
Content-Type: application/json

{
}

### Test forgot password with invalid email format
POST http://localhost:8383/api/auth/forgot-password
Content-Type: application/json

{
  "email": "invalid-email"
}

# ==================================================
# 2. Test Reset Password
# ==================================================

### Test reset password with valid token
POST http://localhost:8383/api/auth/reset-password
Content-Type: application/json

{
  "token": "REPLACE_WITH_TOKEN_FROM_FORGOT_PASSWORD_RESPONSE",
  "newPassword": "mynewpassword123"
}

### Test reset password without token (should fail)
POST http://localhost:8383/api/auth/reset-password
Content-Type: application/json

{
  "newPassword": "mynewpassword123"
}

### Test reset password without password (should fail)
POST http://localhost:8383/api/auth/reset-password
Content-Type: application/json

{
  "token": "some-token"
}

### Test reset password with short password (should fail)
POST http://localhost:8383/api/auth/reset-password
Content-Type: application/json

{
  "token": "some-token",
  "newPassword": "123"
}

### Test reset password with invalid token (should fail)
POST http://localhost:8383/api/auth/reset-password
Content-Type: application/json

{
  "token": "invalid-token-12345",
  "newPassword": "mynewpassword123"
}

### Test reset password with already used token (should fail)
POST http://localhost:8383/api/auth/reset-password
Content-Type: application/json

{
  "token": "REPLACE_WITH_ALREADY_USED_TOKEN",
  "newPassword": "anothernewpassword"
}

# ==================================================
# 3. Test Register (to create a test user)
# ==================================================

### Register a test user
POST http://localhost:8383/api/auth/register
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "originalpassword",
  "firstName": "Test",
  "lastName": "User"
}

# ==================================================
# 4. Test Login (to verify password reset worked)
# ==================================================

### Login with original password (should work before reset)
POST http://localhost:8383/api/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "originalpassword"
}

### Login with new password (should work after reset)
POST http://localhost:8383/api/auth/login
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "mynewpassword123"
}

# ==================================================
# 5. Complete Flow Test Instructions
# ==================================================

###
# HƯỚNG DẪN TEST ĐẦY ĐỦ:
# 
# 1. Chạy server: npm run dev hoặc node server.ts
# 2. Register một user test với email: test@example.com
# 3. Test forgot-password với email đó
# 4. Copy token từ response (trong dev mode)
# 5. Thay thế token vào request reset-password
# 6. Test reset password với token đó
# 7. Verify bằng cách login với password mới
#
# LƯU Ý:
# - Trong development mode, token sẽ được return trong response
# - Trong production mode, token chỉ được gửi qua email
# - Token chỉ có hiệu lực trong 1 giờ
# - Mỗi token chỉ sử dụng được 1 lần
###
